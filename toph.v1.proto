syntax = "proto3";

package toph.v1;

service AccountService { rpc Update(GrpcUpdateAccount) returns (GrpcAccount); }

message GrpcAccount {
  string key = 1;
  string name = 2;
  string email = 3;
}

message GrpcUpdateAccount { string name = 1; }

service SecurityService {
  rpc Authorise(GrpcAuthorisationRequest) returns (GrpcAuthorisationResponse);
  rpc Refresh(GrpcRefreshAuthorisation) returns (GrpcAuthorisationResponse);
}

message GrpcAuthorisationRequest {
  oneof sealed_value { GrpcOpenIdTokenAuthorisationRequest openid = 1; }
}

message GrpcOpenIdTokenAuthorisationRequest {
  string provider = 1;
  string token = 2;
  string device = 3;
}

message GrpcAuthorisationResponse {
  bytes token = 1;
  string refresh_token = 2;
}

message GrpcRefreshAuthorisation {
  bytes token = 1;
  string refresh_token = 2;
  string device = 3;
}